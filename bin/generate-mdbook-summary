#!/usr/bin/env bash
set -euxo pipefail

# Get Inputs
input_dir=$1
output_file=$2
output_file_path="$input_dir/$output_file"

# Generate mdbook summary file from files structure
book-summary --overwrite -n "$input_dir" -o "$output_file"

# Add auto-generated note
sed -i "1s/^/<!-- Auto-generated by 'just dev'. Run 'just generate-mdbook-summary' to manually update  -->\n/" "$output_file_path"

# Format the summary file
prettier --write "$output_file_path"
